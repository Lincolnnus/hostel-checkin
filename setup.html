<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Step Up Mobile System</title>
<link rel="stylesheet" href="css/jquery.mobile-1.1.1.css">
<script src="js/jquery.min.js"></script>
<script src="js/jquery.mobile-1.1.1.js"></script>
<script src="js/cookie.js"></script>
<style>
.ui-collapsible.ui-collapsible-collapsed .ui-collapsible-heading .ui-icon-plus,
.ui-icon-arrow-r { background-position: -108px 0; }
.ui-icon-arrow-l { background-position: -144px 0; }
.ui-icon-arrow-u { background-position: -180px 0; }
.ui-collapsible .ui-collapsible-heading .ui-icon-minus,
.ui-icon-arrow-d { background-position: -216px 0; }
</style>
<script>
    $(document).ready(function() {
                      checkHotel();
                      });
    function editHotel(step)
    {
        switch(step)
        {
            case 1:
            $("#step1").show();$("#confirm1").hide();
            break;
            case 2:
            $("#step2").show();$("#confirm2").hide();
            break;
            case 3:
            $("#step3").show();$("#confirm3").hide();
            break;
        }
    }
    function checkHotel()
    {
        $.ajax({
           type: "get",
           url: "api/hotel.php",
           dataType: "json"
           }).success(function(hotel) {
                      if (hotel.step<=1){$("#confirm1").hide();}
                      else{$("#step1").hide();}
                      if (hotel.step<=2){$("#confirm2").hide();}
                      else{$("#step2").hide();}
                      if (hotel.step<=3){$("#confirm3").hide();$("#confirm4").hide();$("#step4").html("Please Finish Step "+hotel.step+" To Build The App");}
                      else{$("#step3").hide();$("#step4").hide();}
                      $("#name").val(hotel.name);
                      $("#address").val(hotel.address);
                      $("#zip").val(hotel.zip);
                      $("#contact").val(hotel.contact);
                      $("#logourl").val(hotel.logo);
                      $("#logoimg").attr("src",hotel.logo);
                      $("#tac").val(hotel.tac);
            }).fail(function(e){alert("Error With The Server");
            });
    }
    function addHotel(step)
    {
        switch(step)
        {
            case 1:
            var name=$("#name").val();
            var address=$("#address").val();
            var zip=$("#zip").val();
            var contact=$("#contact").val();
            $.ajax({
            type: "post",
            url: "api/hotel.php",
            dataType: "json",
                   data: { name: name,address:address,zip:zip,contact:contact,step:1}
                   }).success(function(e)
                              {window.location.reload();})
                    .fail(function(e){alert("Error With The Server");
                });
            break;
            case 2:
            var logo=$("#logourl").val();
            $.ajax({
                   type: "post",
                   url: "api/hotel.php",
                   dataType: "json",
                   data: { logo: logo,step:2}
                   }).success(function(e)
                              {window.location.reload();
                              })
                    .fail(function(e)
                            {alert("Error With The Server");
            });
            break;
            case 3:
            var tac=$("#tac").val();
            $.ajax({
                   type: "post",
                   url: "api/hotel.php",
                   dataType: "json",
                   data: { tac: tac,step:3}
                   }).success(function(e)
                              {window.location.reload();
                              })
            .fail(function(e)
                  {alert("Error With The Server");
                  });
            break;
            case 4:
            $.ajax({
                   type: "post",
                   url: "api/hotel.php",
                   dataType: "json",
                   data: {step:4}
                   }).success(function(e)
                              {
                                alert("successfully built");
                              })
            .fail(function(e)
                  {alert("Error With The Server");
                  });
        }
    }
</script>
</head>
<body>
<div data-role="page">

	<div data-role="header" data-theme="b" data-add-back-btn="true">
		<h1>Welcome</h1>
        <a href="index.html" data-icon="home" data-iconpos="notext" data-rel="back">Home</a>
        <a href="" data-icon="refresh" data-iconpos="notext" data-transition="fade">Refresh</a>
	</div><!-- /header -->

	<div data-role="content">
        <div><h2>Set Up The System</h2></div>
	<div data-role="collapsible-set">
		<div data-role="collapsible">
            <h3>Step 1: Add Hotel Information</h3>
		<p id="step1">
			    <input type="text" id="name" name="name" placeholder="Hotel Name"/>
			    <input type="text" id="address" name="address" placeholder="Address"/>
                <input type="text" id="zip" name="zip" placeholder="Zip Code"/>
                <input type="text" id="contact" name="contact" placeholder="Contact Number"/>
                <button onclick="addHotel(1)" onkeypress="addHotel(1)" data-theme="b">Save</button>
		</p>
        <p id="confirm1">
            <button theme="a" onclick="editHotel(1)" onkeypress="editHotel(1)">Confirmed</button>
        </p>
		</div>
        <div data-role="collapsible">
            <h3>Step 2: Add Hotel Logo</h3>
            <p id="step2">
                <img id="logoimg" src="images/hotel_icon.png" width="200px"/>
                <input type="text" id="logourl" name="logourl" placeholder="Change Logo Url"/>
                <button onclick="addHotel(2)" onkeypress="addHotel(2)" data-theme="b">Change</button>
            </p>
            <p id="confirm2">
            <button theme="a" onclick="editHotel(2)" onkeypress="editHotel(2)">Confirmed</button>
            </p>
		</div>
        <div data-role="collapsible">
            <h3>Step 3: Additional Information</h3>
            <p id="step3">
            <input type="text" id="tac" name="tac" placeholder="Terms And Conditions"/>
            <button onclick="addHotel(3)" onkeypress="addHotel(3)" data-theme="b">Change</button>
            </p>
            <p id="confirm3">
            <button theme="a" onclick="editHotel(3)" onkeypress="editHotel(3)">Confirmed</button>
            </p>
		</div>
        <div data-role="collapsible" data-collapsed="false">
            <h3>Step 4: Build The App</h3>
            <p id="step4">
            </p>
            <p id="confirm4">
            <button theme="b" onclick="addHotel(4)" onkeypress="addHotel(4)">Build</button>
            </p>
		</div>

	</div>
	</div><!-- /content -->
	<div data-role="footer" data-theme="b"><h4>Copyright&copy;Asplan2012</h4></div> 
</div><!-- /page -->
</body>
</html>
